<!DOCTYPE html>
<html>
<head>
     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>Send SMS</title>
    <meta charset="utf-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
</head>
<body>
    <h1>Send SMS</h1>
    <h1>status: {{modem_statuses}}</h1>
    <table>
        <tr>
            <th>Modem Port</th>
            <th>Status</th>
        </tr>
        {% for modemPort in modemPorts %}
            <tr>
                <td>{{ modemPort }}</td>
                <td>{{ modemStatuses.get(modemPort, 'Unknown') }}</td>
            </tr>
        {% endfor %}
    </table>
    <h1>{{phone_numbers}}</h1>

    <form id="sms-form" method="POST" action="/">
        <label>Enter recipient phone numbers (one number per line):</label><br>
        <textarea name="phone_numbers" rows="4" cols="50" value=""></textarea><br><br>

        <label>Enter message:</label><br>
        <input name="message" rows="4" cols="50" value="test"><br><br>
        <input type="submit" value="Send">
    </form>
<div id="result"></div>
    <h1>{{response}}</h1>
<table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Modem Port</th>
        <th>Phone Number</th>
        <th>Message</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for message in get_data %}
      <tr>
        <td>{{ message[0] }}</td>
        <td>{{ message[4] }}</td>
        <td>{{ message[2] }}</td>
        <td>{{ message[3] }}</td>
        <td>{{ message[1] }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
    <script>
        $(document).ready(function() {
            // Обработка отправки формы через AJAX
            $('#sms-form').submit(function(event) {
                event.preventDefault(); // Предотвращение отправки формы по умолчанию

                // Получение данных формы
                var formData = $(this).serialize();

                // Отправка AJAX-запроса
                $.ajax({
                    url: '/',
                    type: 'POST',
                    data: formData,
                    success: function(response) {
                        // Обработка успешного ответа сервера
                        $('body').html(response);
                    },
                    error: function(error) {
                        // Обработка ошибки
                        console.log(error);
                    }
                });
            });
        });
    </script>
</body>
</html>
